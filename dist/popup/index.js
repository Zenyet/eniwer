import{D as d}from"../chunks/types.js";document.addEventListener("DOMContentLoaded",async()=>{const e=await chrome.storage.local.get(["thecircle_config","thecircle_stats"]),n=e.thecircle_config||d,s=e.thecircle_stats||{usageCount:0,aiCalls:0};l(n.shortcut);const a=document.getElementById("usageCount"),o=document.getElementById("aiCalls");a&&(a.textContent=String(s.usageCount)),o&&(o.textContent=String(s.aiCalls));const r=document.getElementById("openMenu");r==null||r.addEventListener("click",async()=>{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t!=null&&t.id)try{await chrome.tabs.sendMessage(t.id,{type:"TOGGLE_MENU"}),window.close()}catch{try{await chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]}),await chrome.scripting.insertCSS({target:{tabId:t.id},files:["assets/content.css"]}),await new Promise(i=>setTimeout(i,100)),await chrome.tabs.sendMessage(t.id,{type:"TOGGLE_MENU"}),window.close()}catch(i){console.error("Failed to inject:",i),alert("无法在此页面使用。可能是浏览器限制的页面。")}}});const c=document.getElementById("openSettings");c==null||c.addEventListener("click",()=>{chrome.runtime.openOptionsPage()})});function l(e){const n=document.getElementById("shortcutHint");if(!n)return;const s=e.split("+");n.innerHTML=s.map(a=>`<span class="px-2.5 py-1 rounded text-sm font-medium bg-gray-100 border border-gray-200 text-gray-700 dark:bg-white/10 dark:border-white/20 dark:text-white">${a}</span>`).join('<span class="text-sm text-gray-400 dark:text-white/50">+</span>')+'<span class="ml-2 text-sm text-gray-500 dark:text-white/70">呼出菜单</span>'}
